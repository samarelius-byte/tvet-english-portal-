<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>STEAM Malaysia - Student Dashboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .student-portal {
            display: flex;
            width: 100%;
            max-width: 1200px;
            background-color: #fff;
            border-radius: 15px;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.2);
            overflow: hidden;
            height: 700px;
        }

        .sidebar {
            width: 250px;
            background: linear-gradient(to bottom, #4a00e0, #8e2de2);
            color: white;
            padding: 20px;
            display: flex;
            flex-direction: column;
        }

        .logo {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }

        .logo h2 {
            font-weight: 600;
            font-size: 1.3rem;
        }

        .nav-item {
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 8px;
            cursor: pointer;
            transition: background 0.3s;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .nav-item:hover, .nav-item.active {
            background: rgba(255, 255, 255, 0.1);
        }

        .nav-item i {
            font-size: 1.2rem;
        }

        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .header {
            padding: 20px;
            background-color: #f5f7fb;
            border-bottom: 1px solid #e0e0e0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header h1 {
            color: #4a00e0;
            font-size: 1.5rem;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(to right, #4a00e0, #8e2de2);
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            font-weight: bold;
        }

        .content-area {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .dashboard-cards {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 20px;
        }

        .card {
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }

        .card h3 {
            color: #4a00e0;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #f0f0f0;
        }

        .stats {
            display: flex;
            justify-content: space-between;
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: #4a00e0;
        }

        .stat-label {
            font-size: 0.9rem;
            color: #777;
        }

        .progress-container {
            margin-top: 15px;
        }

        .progress-bar {
            height: 10px;
            background-color: #e0e0e0;
            border-radius: 5px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(to right, #4a00e0, #8e2de2);
            border-radius: 5px;
        }

        .chatbot-container {
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        .chat-header {
            background: linear-gradient(to right, #4a00e0, #8e2de2);
            color: white;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .chat-header h2 {
            font-weight: 600;
            font-size: 1.2rem;
        }

        .header-controls {
            display: flex;
            gap: 15px;
        }

        .header-controls button {
            background: transparent;
            border: none;
            color: white;
            cursor: pointer;
            font-size: 1rem;
        }

        .chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 15px;
            background-color: #f9fafc;
        }

        .message {
            max-width: 80%;
            padding: 12px 16px;
            border-radius: 18px;
            line-height: 1.4;
            position: relative;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .user-message {
            align-self: flex-end;
            background-color: #4a00e0;
            color: white;
            border-bottom-right-radius: 5px;
        }

        .bot-message {
            align-self: flex-start;
            background-color: #e8ebf0;
            color: #333;
            border-bottom-left-radius: 5px;
        }

        .message-time {
            font-size: 0.7rem;
            margin-top: 5px;
            opacity: 0.7;
            text-align: right;
        }

        .quick-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
        }

        .quick-action-btn {
            background: rgba(74, 0, 224, 0.1);
            border: none;
            border-radius: 15px;
            padding: 5px 12px;
            font-size: 0.8rem;
            color: #4a00e0;
            cursor: pointer;
            transition: background 0.2s;
        }

        .quick-action-btn:hover {
            background: rgba(74, 0, 224, 0.2);
        }

        .chat-input {
            padding: 15px;
            background-color: white;
            display: flex;
            gap: 10px;
            border-top: 1px solid #e0e0e0;
        }

        .chat-input input {
            flex: 1;
            padding: 12px;
            border: 1px solid #e0e0e0;
            border-radius: 30px;
            outline: none;
            font-size: 0.9rem;
        }

        .chat-input input:focus {
            border-color: #8e2de2;
        }

        .send-button {
            background: linear-gradient(to right, #4a00e0, #8e2de2);
            color: white;
            border: none;
            width: 45px;
            height: 45px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .typing-indicator {
            display: none;
            align-self: flex-start;
            background-color: #e8ebf0;
            padding: 12px 16px;
            border-radius: 18px;
            margin-bottom: 5px;
        }

        .typing-indicator span {
            height: 8px;
            width: 8px;
            float: left;
            margin: 0 1px;
            background-color: #9E9EA1;
            display: block;
            border-radius: 50%;
            opacity: 0.4;
        }

        .typing-indicator span:nth-of-type(1) {
            animation: typing 1s infinite;
        }

        .typing-indicator span:nth-of-type(2) {
            animation: typing 1s 0.33s infinite;
        }

        .typing-indicator span:nth-of-type(3) {
            animation: typing 1s 0.66s infinite;
        }

        @keyframes typing {
            0%, 100% {
                transform: translateY(0);
            }
            50% {
                transform: translateY(-5px);
            }
        }

        .resources-list {
            list-style: none;
        }

        .resources-list li {
            padding: 10px;
            border-bottom: 1px solid #f0f0f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .resources-list li:last-child {
            border-bottom: none;
        }

        .download-btn {
            background: #4a00e0;
            color: white;
            border: none;
            border-radius: 5px;
            padding: 5px 10px;
            cursor: pointer;
            font-size: 0.8rem;
        }

        .api-status {
            text-align: center;
            font-size: 0.8rem;
            padding: 5px;
            background-color: #4caf50;
            color: white;
        }

        .upcoming-items {
            list-style: none;
        }

        .upcoming-items li {
            padding: 10px;
            border-bottom: 1px solid #f0f0f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .upcoming-items li:last-child {
            border-bottom: none;
        }

        .due-date {
            font-size: 0.8rem;
            color: #ff5722;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="student-portal">
        <div class="sidebar">
            <div class="logo">
                <h2>STEAM Learner</h2>
                <p>Student Portal</p>
            </div>
            <div class="nav-item active">
                <i class="fas fa-home"></i>
                <span>Dashboard</span>
            </div>
            <div class="nav-item">
                <i class="fas fa-book"></i>
                <span>My Courses</span>
            </div>
            <div class="nav-item">
                <i class="fas fa-tasks"></i>
                <span>Assignments</span>
            </div>
            <div class="nav-item">
                <i class="fas fa-chart-line"></i>
                <span>Progress</span>
            </div>
            <div class="nav-item">
                <i class="fas fa-calendar"></i>
                <span>Schedule</span>
            </div>
            <div class="nav-item">
                <i class="fas fa-robot"></i>
                <span>AI Tutor</span>
            </div>
            <div class="nav-item">
                <i class="fas fa-cog"></i>
                <span>Settings</span>
            </div>
        </div>
        
        <div class="main-content">
            <div class="header">
                <h1>Student Dashboard</h1>
                <div class="user-info">
                    <div class="user-avatar">SA</div>
                    <span>Student Aiman</span>
                </div>
            </div>
            
            <div class="content-area">
                <div class="dashboard-cards">
                    <div class="card">
                        <h3>My Progress</h3>
                        <div class="stats">
                            <div class="stat-item">
                                <div class="stat-value">85%</div>
                                <div class="stat-label">Overall</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value">92%</div>
                                <div class="stat-label">Science</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value">78%</div>
                                <div class="stat-label">Math</div>
                            </div>
                        </div>
                        <div class="progress-container">
                            <p>Current Course: Form 4 Physics</p>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 65%"></div>
                            </div>
                            <p>65% Complete</p>
                        </div>
                    </div>
                    
                    <div class="card">
                        <h3>Upcoming Assignments</h3>
                        <ul class="upcoming-items">
                            <li>
                                <span>Science Project</span>
                                <span class="due-date">Tomorrow</span>
                            </li>
                            <li>
                                <span>Math Problem Set</span>
                                <span class="due-date">2 days</span>
                            </li>
                            <li>
                                <span>Art Portfolio</span>
                                <span class="due-date">5 days</span>
                            </li>
                        </ul>
                    </div>
                </div>
                
                <div class="card">
                    <h3>AI STEAM Tutor</h3>
                    <div class="api-status">
                        API Connected Successfully - Using DeepSeek Model
                    </div>
                    <div class="chatbot-container">
                        <div class="chat-header">
                            <h2>STEAM Tutor</h2>
                            <div class="header-controls">
                                <button id="minimize-btn"><i class="fas fa-minus"></i></button>
                                <button id="close-btn"><i class="fas fa-times"></i></button>
                            </div>
                        </div>
                        
                        <div class="chat-messages" id="chat-messages">
                            <div class="message bot-message">
                                Hello! I'm your AI STEAM tutor. How can I help you with your studies today?
                                <div class="message-time">Just now</div>
                                <div class="quick-actions">
                                    <button class="quick-action-btn" data-action="Explain a science concept">Explain science</button>
                                    <button class="quick-action-btn" data-action="Help with math problem">Math help</button>
                                    <button class="quick-action-btn" data-action="Project ideas">Project ideas</button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="typing-indicator" id="typing-indicator">
                            <span></span>
                            <span></span>
                            <span></span>
                        </div>
                        
                        <div class="chat-input">
                            <input type="text" id="user-input" placeholder="Ask about science, math, technology, engineering, or art...">
                            <button class="send-button" id="send-btn">
                                <i class="fas fa-paper-plane"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const chatMessages = document.getElementById('chat-messages');
            const userInput = document.getElementById('user-input');
            const sendButton = document.getElementById('send-btn');
            const typingIndicator = document.getElementById('typing-indicator');
            const minimizeBtn = document.getElementById('minimize-btn');
            const closeBtn = document.getElementById('close-btn');
            
            // API configuration
            const API_KEY = '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';
            const API_URL = 'https://openrouter.ai/api/v1/chat/completions';
            
            // Conversation history
            let conversationHistory = [
                {
                    role: "system",
                    content: "You are a helpful STEAM (Science, Technology, Engineering, Art, Math) tutor for Malaysian secondary school students. Your role is to explain concepts, help with homework, provide examples, and guide students in their learning. Always respond in a friendly and encouraging manner. Respond in the same language the student uses (English or Bahasa Malaysia)."
                }
            ];
            
            // Add message to chat
            function addMessage(text, isUser) {
                const messageDiv = document.createElement('div');
                messageDiv.classList.add('message');
                messageDiv.classList.add(isUser ? 'user-message' : 'bot-message');
                
                const time = new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
                
                messageDiv.innerHTML = `${text}<div class="message-time">${time}</div>`;
                chatMessages.appendChild(messageDiv);
                
                // Scroll to bottom
                chatMessages.scrollTop = chatMessages.scrollHeight;
                
                // Add to conversation history
                conversationHistory.push({
                    role: isUser ? "user" : "assistant",
                    content: text
                });
            }
            
            // Show typing indicator
            function showTypingIndicator() {
                typingIndicator.style.display = 'block';
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }
            
            // Hide typing indicator
            function hideTypingIndicator() {
                typingIndicator.style.display = 'none';
            }
            
            // Generate response using API
            async function generateResponse(userMessage) {
                try {
                    // Add user message to conversation history
                    conversationHistory.push({
                        role: "user",
                        content: userMessage
                    });
                    
                    const response = await fetch(API_URL, {
                        method: "POST",
                        headers: {
                            "Authorization": `Bearer ${API_KEY}`,
                            "HTTP-Referer": "https://steam-malaysia-student-portal.com", 
                            "X-Title": "STEAM Malaysia Student Portal",
                            "Content-Type": "application/json"
                        },
                        body: JSON.stringify({
                            "model": "deepseek/deepseek-chat-v3.1:free",
                            "messages": conversationHistory,
                            "temperature": 0.7,
                            "max_tokens": 1000
                        })
                    });
                    
                    const data = await response.json();
                    
                    if (data.error) {
                        return `Error: ${data.error.message}`;
                    }
                    
                    if (data.choices && data.choices.length > 0) {
                        return data.choices[0].message.content;
                    } else {
                        return "I'm sorry, I didn't understand that. Could you try rephrasing your question?";
                    }
                } catch (error) {
                    console.error('API Error:', error);
                    return "I'm having trouble connecting right now. Please try again in a moment.";
                }
            }
            
            // Handle user message
            async function handleUserMessage() {
                const message = userInput.value.trim();
                
                if (message === '') return;
                
                // Add user message to chat
                addMessage(message, true);
                userInput.value = '';
                
                // Show typing indicator
                showTypingIndicator();
                
                try {
                    // Generate response using API
                    const response = await generateResponse(message);
                    hideTypingIndicator();
                    addMessage(response, false);
                } catch (error) {
                    hideTypingIndicator();
                    addMessage("Sorry, I encountered an error processing your request. Please try again.", false);
                }
            }
            
            // Event listeners
            sendButton.addEventListener('click', handleUserMessage);
            
            userInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    handleUserMessage();
                }
            });
            
            // Quick action buttons
            document.querySelectorAll('.quick-action-btn').forEach(button => {
                button.addEventListener('click', function() {
                    const action = this.getAttribute('data-action');
                    userInput.value = action;
                    handleUserMessage();
                });
            });
            
            minimizeBtn.addEventListener('click', function() {
                const chatBody = document.querySelector('.chat-messages');
                const chatInput = document.querySelector('.chat-input');
                const typingIndicator = document.getElementById('typing-indicator');
                
                if (chatBody.style.display === 'none') {
                    chatBody.style.display = 'flex';
                    chatInput.style.display = 'flex';
                    typingIndicator.style.display = 'none';
                    minimizeBtn.innerHTML = '<i class="fas fa-minus"></i>';
                } else {
                    chatBody.style.display = 'none';
                    chatInput.style.display = 'none';
                    typingIndicator.style.display = 'none';
                    minimizeBtn.innerHTML = '<i class="fas fa-plus"></i>';
                }
            });
            
            closeBtn.addEventListener('click', function() {
                const confirmed = confirm('Are you sure you want to clear the chat?');
                if (confirmed) {
                    // Clear chat but keep welcome message
                    const welcomeMsg = document.querySelector('.bot-message');
                    chatMessages.innerHTML = '';
                    chatMessages.appendChild(welcomeMsg);
                    
                    // Reset conversation history
                    conversationHistory = [
                        {
                            role: "system",
                            content: "You are a helpful STEAM (Science, Technology, Engineering, Art, Math) tutor for Malaysian secondary school students. Your role is to explain concepts, help with homework, provide examples, and guide students in their learning. Always respond in a friendly and encouraging manner. Respond in the same language the student uses (English or Bahasa Malaysia)."
                        }
                    ];
                    
                    // Add a new bot message
                    addMessage("Hello again! How can I help with your STEAM studies today?", false);
                }
            });
            
            // Add some sample messages after a delay to simulate a conversation starter
            setTimeout(() => {
                addMessage("I can help explain concepts, solve problems, and give examples for Science, Technology, Engineering, Art, and Math. What would you like to learn about?", false);
            }, 3000);
        });
    </script>
</body>
</html>